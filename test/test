#include "SerialTransfer.h"


SerialTransfer myTransfer;


void setup()
{
  Serial.begin(115200);
  myTransfer.begin(Serial);
}

typedef struct {
	uint16_t len;
	byte data[128];
} Data;

void loop() {
	if (myTransfer.available()) {
	// send all received data back to Python
	//for(uint16_t i=0; i < myTransfer.bytesRead; i++)
	//  myTransfer.txBuff[i] = myTransfer.rxBuff[i] & 0xFE;

	Data data;
	myTransfer.rxObj(data.len, 2, 0);
	myTransfer.rxObj(data.data, data.len, 2);
	for (int i = 0; i < data.len; i++) {
		data.data[i]++;
	}
	myTransfer.txObj(data, sizeof(data), 0);

	myTransfer.sendData(sizeof(data));
	}
}